[![ЮKassa](/i/yookassalogo.png "ЮKassa")](https://yookassa.ru) / [помощь](https://yookassa.ru/docs/support) / [api-докуметация](https://yookassa.ru/developers), [Checkout.js](https://yookassa.ru/developers/payment-forms/other/yc-js), [SDK](https://yookassa.ru/developers/using-api/using-sdks)

# Обновление платежного протокола ЮKassa (метод b2b_sberbank)

> Эта страница предназначена для тех контрагентов, кто принимает платежи методом **[СберБанк Бизнес Онлайн](https://yookassa.ru/developers/payment-acceptance/integration-scenarios/manual-integration/other/b2b-sberbank)**  
> **Обязательно покажите это письмо вашему техническому специалисту или программисту**, чтобы он проверил на вашей стороне, что при отсутствии `kpp` в объекте платежа, не ломался процесс обработки платежа на вашей стороне.

### Подробности

Проверьте совместимость вашего ПО. В ближайшие две недели (до 10.04.2022) будет проведено обновление платежного протокола ЮKassa в части метода `b2b_sberbank`. После обновления, если значение `kpp` из объекта `payer_bank_details` будет пустое, то оно не будет передаваться.

>> Этот объект (информация по платежу) и `kpp` передаем вам мы после того, как плательщик успешно оплачивает выставленный вами счет платежным методом *СберБанк Бизнес Онлайн*.  До обновления нашего платежного протокола ЮKassa, на текущий момент, пока это значение передается. Пример ниже.

Данное изменение может повлиять на процесс обработки информации о платеже с вашей стороны. Например, если с вашей стороны есть условие, по которому ваша система ожидает, чтобы поле `kpp` было всегда, даже если оно пустое. Еще раз обращаем ваше внимание, что после обновления могут быть случаи, когда мы вам вообще НЕ будем передавать `kpp`, его не будет в объекте платежа, если оно пустое.

### Краткий пример с пустым kpp (сейчас, до обновления, оно передается именно так)
```
      "payer_bank_details" : {
        "full_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "short_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "address" : "692441, Приморский край, г.Дальнегорск, ул. Осипенко, дом 274",
        "inn" : "300001500700",
        "kpp" : "",
        "bank_name" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_branch" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_bik" : "000700900",
        "account" : "405043210509000004990"
      }
```

## Пример текущего объекта платежа с пустым kpp
Сейчас в нем передается пустое значение `kpp` (см. `payer_bank_details`):
```{
    "id" : "29c7de2-000f-5000-8000-1709f5f07f06",
    "status" : "succeeded",
    "amount" : {
      "value" : "1000.00",
      "currency" : "RUB"
    },
    "income_amount" : {
      "value" : "972.00",
      "currency" : "RUB"
    },
    "description" : "Платеж за услуги, счет N 100500",
    "recipient" : {
      "account_id" : "100500",
      "gateway_id" : "100700"
    },
    "payment_method" : {
      "type" : "b2b_sberbank",
      "id" : "29c53de2-000f-5000-8000-1709f5f07f06",
      "saved" : false,
      "payment_purpose" : "Платеж за услуги, счет N 100500",
      "vat_data" : {
        "type" : "untaxed"
      },
      "payer_bank_details" : {
        "full_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "short_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "address" : "692441, Приморский край, г.Дальнегорск, ул. Осипенко, дом 274",
        "inn" : "300001500700",
        "kpp" : "",
        "bank_name" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_branch" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_bik" : "000700900",
        "account" : "405043210509000004990"
      }
    },
    "captured_at" : "2022-03-17T12:33:48.241Z",
    "created_at" : "2022-03-17T12:31:30.023Z",
    "test" : false,
    "refunded_amount" : {
      "value" : "0.00",
      "currency" : "RUB"
    },
    "paid" : true,
    "refundable" : true,
    "metadata" : { }
  }
```

## Как будет после обновления

После обновления платежного протокола, в случае, если `kpp` будет пустым (когда Сбербанку не известно его значение), оно не будет передаваться вам в объекте платежа.

### Пример, где kpp нет и оно не передано в объекте платежа (так будет после обновления)
```
      "payer_bank_details" : {
        "full_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "short_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "address" : "692441, Приморский край, г.Дальнегорск, ул. Осипенко, дом 274",
        "inn" : "300001500700",
        "bank_name" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_branch" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_bik" : "000700900",
        "account" : "405043210509000004990"
      }
```

### Пример, где kpp есть и оно передано в объекте платежа (так будет после обновления)

```
      "payer_bank_details" : {
        "full_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "short_name" : "Индивидуальный предприниматель Иванов Сергей Борисович",
        "address" : "692441, Приморский край, г.Дальнегорск, ул. Осипенко, дом 274",
        "inn" : "300001500700",
        "kpp" : "123450333",
        "bank_name" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_branch" : "Среднерусский банк Публичное акционерное общество \"Сбербанк России\"",
        "bank_bik" : "000700900",
        "account" : "405043210509000004990"
      }
```

## У меня есть вопрос

Если есть вопросы, напишите нам — на b2b_support@yoomoney.ru.

### Текст рассылки

```
Тема: Обновление платежного протокола ЮKassa (метод b2b_sberbank) | проверьте совместимость вашего ПО

Коллеги,

в ближайшие две недели (до 10.04.2022) будет проведено обновление платежного протокола ЮKassa в части метода b2b_sberbank. 
После обновления, если значение kpp из объекта payer_bank_details будет пустое, то оно не будет передаваться. 
Этот объект (информацию по платежу) передаем вам мы.

Покажите это письмо вашему техническому специалисту или программисту, чтобы он проверил на вашей стороне, что при отсутствии 
этого параметра в объекте платежа, не ломается процесс обработки платежа на вашей стороне. 

Подробнее https://github.com/yoomoney/yookassa-github-docs/blob/master/checkout-api/b2b_sberbank_kpp_value_update.md

Ваш shopid=100500

Если есть вопросы, пишите в ответ на это письмо.
```
