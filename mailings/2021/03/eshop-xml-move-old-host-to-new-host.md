<!--
...
-->

Смена хоста money.yandex.ru на yoomoney.ru
==========================================

> В 2020 году, в связи с [ребрендином сервиса](https://yoomoney.ru/page?id=536896), также стало необходимым и обновление хостов, куда вы по платежному протоколу отправляете ваши запросы в ЮKassa. Если не обновить хост в коде вашей системы (или не обновить платежный модуль в CMS), то платежи перестанут работать.  
> На этой странице представлены пояснения к рассылке.

### Пример

```
- <form action="https://money.yandex.ru/eshop.xml">
+ <form action="https://yoomoney.ru/eshop.xml">
```

## Документация

* [Документация по старому платежному протоколу](https://yookassa.ru/docs/payment-solution)
* [Подробности о смене бренда](https://new.yookassa.ru/)
* [Обзор по всем техническим изменениям](https://yoomoney.ru/i/html-letters/Tech_Guide_2020_kassa_rus.pdf)


## Что сделать

### CMS

1. Если у вас CMS, найдите инструкцию на нашем сайте https://yookassa.ru/integration/:
> ![image](/i/how-to-find-yookassa-cms-module-v2.png)
2. Прочитайте инструкцию по установке, настройке, скачайте обновленный модуль и установите его. Или выполните обновление так, как это делается для вашей CMS.


### Cамописное ПО

1. После того, как вы в коде вашего ПО замените хост в `action` платежной формы на новый, платежи продолжат работать как и прежде. Смена хоста - это единственное изменение, которое требуется, чтобы вы внесли в код своей системы, чтобы в определенный момент платежи не сломались.
2. В какой-то момент старый хост `money.yandex.ru` перестанет работать (точных сроков, к сожалению, сказать не можем) и, как следствие, перестанут работать платежи. Поэтому наилучшим решением будет - обновить ваши скрипты заранее, прописав в них новый хост `yoomoney.ru`.
3. Если вы интегрировали еще какие-то наши протоколы, в них также надо обновить хост. См. таблицу хостов ниже.

<!-- ### Как протестировать
> вводный текст
> 
1. пункты
#### N.B.
...
-->

## Старые и новые хосты

> Эта таблица пригодится вашему программисту, если вы используете при работе с ЮKassa не один протокол. Для каждого протокола обновился только хост. И если его обновить (см. в таблице значение нового), прописав в коде вашего ПО новый хост, то это гарантия того, что когда старый хост перестанет работать, у вас в плане платежей, возвратов, выплат и т.п., все продолжит работать штатно.

| Протокол | Старый хост | Новый хост |
| -------- | ----------- | ---------- |
|  |
| [API новый платежный](https://yookassa.ru/developers/using-api/basics) | `payment.yandex.net/api/v3` | `api.yookassa.ru/v3/` |
| [Старый платежный протокол](https://yookassa.ru/docs/payment-solution) | `money.yandex.ru/eshop.xml` | `yoomoney.ru/eshop.xml`
| [MWS](https://yookassa.ru/docs/payment-solution/payment-management/basics) | `penelope.yamoney.ru` | `shop.yookassa.ru` |
|  |
| [Протокол выплат](https://yookassa.ru/docs/payouts) | `calypso.yamoney.ru` | `payouts.yookassa.ru` |
| [Протокол зачислений](https://yoomoney.ru/docs/depositions) | `calypso.yamoney.ru` | `deposit.yoomoney.ru` |
| Протокол идентификации кошелька `*` (`makeIdentificationDeposition`) | `calypso.yamoney.ru` | `deposit.yoomoney.ru` |
| Host2host PCI DSS протокол | `paymentcard.yamoney.ru` | `paymentcard.yoomoney.ru` | 

---

## FAQ

### // Обновление кода

**Q:** Мой сайт был сделан давно, я не могу сам поправить код, можете с этим помочь?

**A:** Лучше всего привлечь специалиста, кто знает или сможет понять как работает ваш проект изнутри (код). Если такого не найдете, то напишите нам, посмотрим, что можно сделать. В любом случае, нам потребуется доступ к вашей системе, чтобы внести эту правку. Опять же, сможем ли мы обновить ваш код станет понятно только посмотрев на ваш проект.

### // Я уже обновился

**Q:** Я уже все обновил мое ПО и|или модуль CMS, зачем вы мне пишите?

**A:** Выборка была сделана по всем обращениям к старому хосту за весь март 2021. Если вы уже обновились, то хорошо.

### // CMS|SaaS|PaaS

**Q:** Мой сайт написан на известной CMS, как я могу внести правки в ее код?

**A:** Если у вас CMS, то достаточно обновить платежный модуль до последней версии. На текущий момент большинство разработчиков выпустили (начиная с декабря 2020) обновленные версии своих модулей, где внесены все необходимые правки, в том числе, для того, чтобы ваша система начала работать через новый хост `yoomoney.ru`.

### // Не могу обновиться

**Q:** А если я не успею обновить?

**A:** К сожалению, платежи перестанут работать. Мы делаем все возможное, чтобы работоспособность всех старых адресов, включая `money.yandex.ru/eshop.xml` была как можно дольше. **Постарайтесь обновиться до конца апреля 2022**.

> Если все-таки платежи перестанут работать, посмотрите на решение "[Выставление счетов из ЛК ЮKassa](https://yookassa.ru/docs/support/merchant/payments/invoicing)". Оно будет работать всегда вне зависимости ПО вашего сайта. Это может быть для вас временным решением по приему платежей.

### Текст рассылки

```
#### Обновите ваше платежное ПО для работы с ЮKassa

По вашему магазину платежи идут на старый URL платежной системы ЮKassa.

#### Что нужно сделать?

Платежи должны начать ходить на новый адрес yoomoney.ru, а не на старый money.yandex.ru.

Подробнее о том, как обновиться
https://github.com/yoomoney/yookassa-github-docs/blob/master/mailings/2021/03/eshop-xml-move-old-host-to-new-host.md

#### А если не обновлять?

Если обновление не сделать, то платежи, к сожалению, перестанут работать в ближайшие несколько недель.

Внимание! Проверьте, чтобы обновление было выполнено на всех учетных записях (shopid) и сайтах, которые вы используете.

#### У меня есть вопрос

Если остались вопросы или что-то не получается, напишите нам — на b2b_support@yoomoney.ru или в ответ на это письмо.
```

<!-- 
# Было
BASE_URL:"https://payment.yandex.net",
TOKENIZE_URL:"payment-api/checkout-js/api/v1/tokenize",
TOKENIZE_CSC_URL:"payment-api/checkout-js/api/v1/tokenize/csc",
BUILD_NAME:"yandex-checkout.js",
ThreatMetrixServerHost:"https://s4.money.yandex.net/"

# Стало
BASE_URL:"https://sdk.yookassa.ru",
TOKENIZE_URL:"checkout-js/api/v1/tokenize",
TOKENIZE_CSC_URL:"checkout-js/api/v1/tokenize/csc",
BUILD_NAME:"yoomoney-checkout.js",
ThreatMetrixServerHost:"https://s4.partner.yoomoney.ru/"
-->
